{% extends 'base.html' %}

{% block head %}
    {{ super() }}
    <script type="text/javascript" src="{{ url_for('static', filename='js/units.js') }}"></script>
{% endblock %}
{% block content %}
    <div class="row super-row">
        <div class="col-sm-12 col-centered">
            {% for key, unit in units.items() %}
            {% set key_id=key.replace(" ", "-") %}
                {% set max_buff=max_buffs[loop.index-1] %}
                {% set max_add_buff=max_add_buffs[loop.index-1] %}
                {%if (loop.index-1) % 4 == 0 %}
                    <div class="row centered-row">
                {% endif %}
                    <div class="col-lg-3 col-6 border block">
                        <div class="row centered-row">
                            <div class="col-9">
                                <div class="row centered-row">
                                    <div class="col-6">
                                        <a href="{{unit['img'].replace('img', 'https://www.endlessfrontierdata.com').replace('.png', '')}}">
                                            <img id="{{key_id}}-image" src="../static/{{unit['img']}}" data-toggle="tooltip" data-placement="top" title="{{key}}">
                                        </a>
                                    </div>
                                    <div class="col-6">
                                        <a href="{{unit['img'].replace('img', 'https://www.endlessfrontierdata.com').replace('.png', '')}}">
                                            <img id="{{key_id}}-image" src="../static/{{unit['img_sr']}}" data-toggle="tooltip" data-placement="top" title="Senior {{key}}">
                                        </a>
                                    </div>
                                </div>
                                <div class="row centered-row">
                                    <div class="col-6">
                                        <input id="{{key_id}}-fragments" data-pet="{{key_id}}" class="form-control pet-input" type="number" min="0" value="0"/>
                                    </div> 
                                    <div class="col-6">
                                        <input id="{{key_id}}-fragments" data-pet="{{key_id}}" class="form-control pet-input" type="number" min="0" value="0"/>
                                    </div>
                                </div>
                            </div>
                            <div class="col-3">
                                <a href="{{pets[unit['pet']]['img'].replace('img', 'https://www.endlessfrontierdata.com').replace('.png', '')}}">
                                    <img id="{{key_id}}-image" class='unit-image' src="../static/{{pets[unit['pet']]['img']}}">
                                </a>
                            </div>
                        </div>
                        {% for i in range(max_buff) %}
                        <div class="row centered-row">
                                <div class="col-12">
                                    {%if i < unit["buffs"]|length %}
                                        {% set buff=unit["buffs"][i] %}
                                        <span data-toggle="popover" title="{{buff['name']}}" data-content="{{buff['description']}}" data-trigger="hover" data-placement="top">
                                            <div class='progress unit-bar'>
                                                <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0/{{buff["requirement"]}}
                                                </div>
                                            </div>
                                        </span>
                                    {% else %}
                                    <div class='progress unit-bar progress-bar-hidden'>
                                        <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        {% endfor %}
                        {% for i in range(max_add_buff) %}
                        <div class="row centered-row">
                                <div class="col-12">
                                    {%if i < pets[unit["pet"]]["additional_buffs"]|length %}
                                        {% set buff=pets[unit["pet"]]["additional_buffs"][i] %}
                                        <span data-toggle="popover" title="{{buff['name']}}" data-content="{{buff['description']}}" data-trigger="hover" data-placement="top">
                                            <div class='progress unit-bar progress-bar-hidden'>
                                                <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0/{{buff["requirement"]}}
                                                </div>
                                            </div>
                                        </span>
                                    {% else %}
                                    <div class='progress unit-bar progress-bar-hidden'>
                                        <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                    {% endif %}
                                </div>
                        </div>
                        {% endfor %}
                    </div>
                {%if (loop.index-1) % 4 == 3 %} </div>  {% endif %}
            {% endfor %}
        </div>
    </div>

    <script type="text/javascript">
    $(function () {
        $('[data-toggle="popover"]').popover()
    });

    $(function () {
        $('[data-toggle="tooltip"]').tooltip()
    }); 
    </script>
{% endblock %}